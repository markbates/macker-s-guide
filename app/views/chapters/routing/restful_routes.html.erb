<% page_title('RESTful/Resource Routes') -%>

<p>By default every route you define in Mack is <%= link_to('RESTful', 'http://en.wikipedia.org/wiki/Representational_State_Transfer', :target => :_blank) %>. Unless you specify a route, it will default to the HTTP verb GET.</p>

<% code do -%>
Mack::Routes.build do |r|
  r.home_page '/', :controller => :default, :action => :index
  r.users_create '/users', :controller => :users, :action => :create, :method => :post
end
<% end -%>

<p>In the above example when a request comes in that matches the url '/' and is of type GET then it will be sent to the <code>DefaultController</code> and the <code>index</code> action. If '/' comes in on ANY other HTTP verb, it will not be matched a <code>Mack::Errors::ResourceNotFound</code> error will be raised. The same holds true if a request comes in that matches '/users', if it's a POST then it will go to the <code>UsersController</code> and the <code>create</code> action.</p>

<p>As demonstrated above you can set the HTTP method with <code>:method => :get|:post|:put|:delete</code></p>

<p>It is very much so possible to 'overload' a url by specifying many routes with different methods.</p>

<% code do -%>
Mack::Routes.build do |r|
  r.users_index '/users', :controller => :users, :action => :index
  r.users_create '/users', :controller => :users, :action => :create, :method => :post
end
<% end -%>

<p>In this example if '/users' is GET request, then it will be sent to <code>UsersController#index</code> if it's a POST request it will be sent to <code>UsersController#create</code>.</p>

<p>If you want to map a full suite of RESTful routes, you can do this with just one line:</p>

<% code do -%>
Mack::Routes.build do |r|
  r.resource :users
end
<% end -%>

<p>This is the equivalent of mapping the following routes:</p>

<% code do -%>
Mack::Routes.build do |r|
  r.users_index '/users', :controller => :users, :action => :index
  r.users_new '/users/new', :controller => :users, :action => :new
  r.users_show '/users/:id', :controller => :users, :action => :show
  r.users_edit '/users/:id/edit', :controller => :users, :action => :edit
  r.users_create '/users', :controller => :users, :action => :create, :method => :post
  r.users_update '/users/:id', :controller => :users, :action => :update, :method => :put
  r.users_delete '/users/:id', :controller => :users, :action => :delete, :method => :delete
end
<% end -%>

<p>Resource routes in Mack can easily be extended by passing in an optional block, like such:</p>

<% code do -%>
Mack::Routes.build do |r|
  r.resource :users do |user|
    user.foo '/users/foo', :action => :foo
    user.hello '/hello/:id', :action => :hello, :method => :put
  end
end
<% end -%>

<p>This is the equivalent of mapping the following routes:</p>

<% code do -%>
Mack::Routes.build do |r|
  r.users_foo '/users/foo', :controller => :users, :action => :foo
  r.users_hello '/users/hello/:id', :controller => :users, :action => :hello, :method => :put
  r.users_index '/users', :controller => :users, :action => :index
  r.users_new '/users/new', :controller => :users, :action => :new
  r.users_show '/users/:id', :controller => :users, :action => :show
  r.users_edit '/users/:id/edit', :controller => :users, :action => :edit
  r.users_create '/users', :controller => :users, :action => :create, :method => :post
  r.users_update '/users/:id', :controller => :users, :action => :update, :method => :put
  r.users_delete '/users/:id', :controller => :users, :action => :delete, :method => :delete
end
<% end -%>

<p>There are a couple of things to notice here. One is that the routes defined in the block actually get generated <i>before</i> the routes that normally get generated by the <code>resource</code> method. Also note that the <code>foo</code> and <code>hello</code> named routes actually got namespaced with 'users_'. This helps to tie them to the user resource. Finally, note that the hello route, '/hello/:id', became '/users/hello/:id', again this is to tie it to the the user resource.</p>